// SockJS ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë“œ

const sockjsScript = document.createElement("script");
sockjsScript.src = "https://cdnjs.cloudflare.com/ajax/libs/sockjs-client/1.5.1/sockjs.min.js";
document.head.appendChild(sockjsScript);

// STOMP ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë“œ
const stompScript = document.createElement("script");
stompScript.src = "https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js";
document.head.appendChild(stompScript);

console.log("âœ… SockJS & STOMP.js ë¡œë“œ ì™„ë£Œ!");

// ì›¹ì†Œì¼“ ì—°ê²°

const socket = new SockJS("http://localhost:8080/ws-stomp"); // ì„œë²„ ì£¼ì†Œ
const stompClient = Stomp.over(socket);

stompClient.connect({}, function (frame) {
    console.log("âœ… ì—°ê²° ì„±ê³µ: " + frame);
}, function (error) {
    console.error("âŒ ì—°ê²° ì‹¤íŒ¨: " + error);
});

// ë©”ì„¸ì§€ êµ¬ë…

stompClient.subscribe("/sub/channel/100", function (message) {
    console.log("ğŸ“© ë°›ì€ ë©”ì‹œì§€: ", message.body);
});


// ë©”ì„¸ì§€ ë°œí–‰
stompClient.send("/pub/channel", {}, JSON.stringify({
    channelId: "100",
    message: "Hello, WebSocket!"
}));

// ì—°ê²° í•´ì œ
stompClient.disconnect(function () {
    console.log("ğŸ”Œ ì—°ê²° ì¢…ë£Œ");
});
